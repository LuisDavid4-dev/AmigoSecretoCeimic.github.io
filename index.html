<!DOCTYPE html>
<html lang="es">
<head>
    <link rel="stylesheet" href="estilos.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Intercambio NavideÃ±o 2025</title>
</head>
<body>
    <div class="snowflakes" aria-hidden="true"></div>
    <div id="christmas-loader">
        <img src="Bienvenida.webp" alt="Feliz Navidad"> 
    </div>

    <div id="user-modal" class="modal">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <div class="modal-header">
                </div>
            <div class="modal-body">
                </div>
        </div>
    </div>
 
    <header class="navidad-header">
        <div class="header-content-wrapper"> <div class="header-line">
                <span class="arbol-decor arbol-izq">ğŸ„</span> 
                <h1>Intercambio NavideÃ±o 2025</h1>
                <span class="arbol-decor arbol-der">ğŸ„</span> 
            </div>
            
            <div class="header-line">
                <span class="estrella estrella-izq">âœ¨</span>
                <h2 class="titulo-rojo-navidad">Â¡Feliz Navidad!</h2>
                <span class="estrella estrella-der">âœ¨</span>
            </div>
            
            </div>
    </header>
    <div class="product-grid">
        <!--
        <div class="product-card" onclick="openModal('Amigo 1', 'https://i.imgur.com/8uO0M3j.jpg', 'Edad: 28, Gustos: TecnologÃ­a, Color Favorito: Azul', 'Le encanta el cafÃ© y los libros. El regalo debe ser funcional y elegante. Evitar cosas muy personales.')">
            <span class="card-icon-emoji"></span>  <div class="card-content">
            <img src="amigo.jpg" alt="Foto de Amigo 1">
            <h3>Amigo 1</h3>
            </div>
            <p>Le encanta el cafÃ© y los libros.</p> 
        </div>

        <div class="product-card" onclick="openModal('Amigo 2', 'https://i.imgur.com/8uO0M3j.jpg', 'Edad: 35, Gustos: JardinerÃ­a, Color Favorito: Verde', 'Necesita algo para su escritorio. Algo que aporte paz y naturaleza a su espacio de trabajo.')">
            <span class="card-icon-emoji"></span>  <div class="card-content">
            <img src="amigo.jpg" alt="Foto de Amigo 2">
            <h3>Amigo 2</h3>
            </div>
            <p>Necesita algo para su escritorio.</p>
        </div>

        <div class="product-card" onclick="openModal('Amigo 3', 'https://i.imgur.com/8uO0M3j.jpg', 'Edad: 22, Gustos: Viajar, Color Favorito: Amarillo', 'Algo azul o relacionado con el mar. Un accesorio de viaje pequeÃ±o y Ãºtil serÃ¡ bien recibido.')">
            <span class="card-icon-emoji"></span>  <div class="card-content">
            <img src="amigo.jpg" alt="Foto de Amigo 3">
            <h3>Amigo 3</h3>
            </div>
            <p>Algo azul o relacionado con el mar.</p>
        </div>

        <div class="product-card" onclick="openModal('Amigo 4', 'https://i.imgur.com/8uO0M3j.jpg', 'Edad: 30, Gustos: Cocina, Color Favorito: Rojo', 'Un dulce regalo comestible. Prefiere lo artesanal o gourmet.')">
            <span class="card-icon-emoji"></span> <div class="card-content">
            <img src="amigo.jpg" alt="Foto de Amigo 4">
            <h3>Amigo 4</h3>
            </div>
            <p>Un dulce regalo comestible.</p>
        </div>
        -->
    </div>

    <script>
        // --- 1. FUNCIONES DE UTILERÃA (DEFINIDAS PRIMERO) ---

        function adjustSnowflakeHeight() {
Â  Â  Â  Â  Â  Â  const snowflakes = document.querySelector('.snowflakes');
Â  Â  Â  Â  Â  Â  // document.body.scrollHeight da la altura total del contenido, incluyendo lo que no se ve.
Â  Â  Â  Â  Â  Â  const totalHeight = document.body.scrollHeight;
Â  Â  Â  Â  Â  Â  snowflakes.style.height = `${totalHeight}px`;
Â  Â  Â  Â  }
        
Â  Â  Â  Â  function createSnowflake() {
Â  Â  Â  Â  Â  Â  const snowflake = document.createElement('div');
Â  Â  Â  Â  Â  Â  snowflake.className = 'snowflake';
Â  Â  Â  Â  Â  Â  snowflake.innerHTML = 'â€¢'; 
Â  Â  Â  Â  Â  Â  const startX = Math.random() * 100;
Â  Â  Â  Â  Â  Â  snowflake.style.left = `${startX}vw`;
Â  Â  Â  Â  Â  Â  const size = Math.random() * 0.5 + 0.8; 
Â  Â  Â  Â  Â  Â  snowflake.style.fontSize = `${size}em`;
Â  Â  Â  Â  Â  Â  const duration = Math.random() * 10 + 10; 
Â  Â  Â  Â  Â  Â  snowflake.style.animationDuration = `${duration}s`;
Â  Â  Â  Â  Â  Â  const delay = Math.random() * 10;
Â  Â  Â  Â  Â  Â  snowflake.style.animationDelay = `${delay}s`;
Â  Â  Â  Â  Â  Â  return snowflake;
Â  Â  Â  Â  }

Â  Â  Â  Â  function initSnowfall() {
Â  Â  Â  Â  Â  Â  const snowfallContainer = document.querySelector('.snowflakes');
Â  Â  Â  Â  Â  Â  const numberOfSnowflakes = 50; 
Â  Â  Â  Â  Â  Â  for (let i = 0; i < numberOfSnowflakes; i++) {
Â  Â  Â  Â  Â  Â  Â  Â  snowfallContainer.appendChild(createSnowflake());
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

        // --- 2. CÃ“DIGO DEL MODAL (Mantenido) ---

Â  Â  Â  Â  const modal = document.getElementById('user-modal');
Â  Â  Â  Â  const closeBtn = document.querySelector('.close-btn');

Â  Â  Â  Â  function openModal(name, imgSrc, basicInfo, fullInfo) {
Â  Â  Â  Â  Â  Â  const modalHeader = document.querySelector('.modal-header');
Â  Â  Â  Â  Â  Â  const modalBody = document.querySelector('.modal-body');
            
            document.body.classList.add('modal-open');

Â  Â  Â  Â  Â  Â  const formattedBasicInfo = basicInfo
Â  Â  Â  Â  Â  Â  Â  Â  .split(', ') 
Â  Â  Â  Â  Â  Â  Â  Â  .map(item => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const parts = item.split(': '); 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (parts.length === 2) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return `<strong>${parts[0]}:</strong><br> ${parts[1]}`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return item; 
Â  Â  Â  Â  Â  Â  Â  Â  })
Â  Â  Â  Â  Â  Â  Â  Â  .join('<br>'); 

Â  Â  Â  Â  Â  Â modalHeader.innerHTML =
Â  Â  Â  Â  Â  Â  Â  Â  '<div class="modal-title">'+
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  '<h3 class="modal-title-h3">'+name+'</h3>'+
Â  Â  Â  Â  Â  Â  Â  Â  '</div>'+
Â  Â  Â  Â  Â  Â  Â  Â  '<div class="modal-header-content-wrapper">'+
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  '<div class="modal-visual-info">'+
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  '<img src="'+imgSrc+'" alt="Foto de '+name+'" class="modal-img">'+
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  '<div class="modal-info-top">'+
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  '<p>'+formattedBasicInfo+'</p>'
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  '</div>'+
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  '</div>'+
Â  Â  Â  Â  Â  Â  Â  Â  '</div>'+
Â  Â  Â  Â  Â  Â  Â  Â  '<div class="modal-divider"></div>';

Â  Â  Â  Â  Â  Â  modalBody.innerHTML = 
Â  Â  Â  Â  Â  Â  Â  Â  '<h4>Detalle del Amigo Secreto:</h4>'+
Â  Â  Â  Â  Â  Â  Â  Â  '<p>'+fullInfo+'</p>';

Â  Â  Â  Â  Â  Â  modal.style.display = 'flex';
Â  Â  Â  Â  }

Â  Â  Â  Â  closeBtn.onclick = function () {
Â  Â  Â  Â  Â  Â  modal.style.display = 'none';
Â  Â  Â  Â  }

Â  Â  Â  Â  window.onclick = function (event) {
Â  Â  Â  Â  Â  Â  if (event.target === modal) {
Â  Â  Â  Â  Â  Â  Â  Â  modal.style.display = 'none';
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
        
        // --- 3. BLOQUE PRINCIPAL DE CARGA (document.addEventListener('DOMContentLoaded')) ---
        // Este bloque ahora contiene toda la lÃ³gica de inicio.

        function activateChristmasDayMode() {
            const today = new Date();
            // Diciembre es 11, dÃ­a 25.
            const isChristmasDay = today.getMonth() === 11 && today.getDate() === 19;
            // Para pruebas puedes cambiar a: const isChristmasDay = true; 

            if (isChristmasDay) {
                // 1. CAMBIAR EL TÃTULO
                const mainTitle = document.querySelector('.titulo-rojo-navidad');
                if (mainTitle) {
                    mainTitle.innerHTML = 'Â¡Es Hoy! ğŸ…ğŸ';
                    mainTitle.style.fontSize = '5em'; 
                    mainTitle.style.color = 'var(--verde-navidad)'; 
                }
                
                // 2. REEMPLAZAR DECORACIONES DEL HEADER
                const arbolDecor = document.querySelectorAll('.arbol-decor');
                arbolDecor.forEach(decor => {
                    decor.innerHTML = 'ğŸ¦Œ'; // Renos
                    decor.style.color = 'var(--rojo-navidad)'; 
                });

                const estrellaDecor = document.querySelectorAll('.estrella-decor');
                estrellaDecor.forEach(decor => {
                    decor.innerHTML = 'ğŸ'; // Regalos
                    decor.style.fontSize = '3em';
                });

                // 3. ACTIVAR EFECTO VISUAL
                document.body.style.backgroundImage = 'radial-gradient(circle, rgba(255,255,255,0.3) 1px, transparent 1px)';
                document.body.style.backgroundSize = '50px 50px';
                document.body.style.animation = 'none'; 
                
                // Opcional: Cambiar el color del borde de las tarjetas
                document.documentElement.style.setProperty('--azul-hielo-vivo', 'var(--rojo-navidad)');
            }
        }

Â  Â  Â  Â  document.addEventListener('DOMContentLoaded', () => {
Â  Â  Â  Â  Â  Â  const iconList = ["ğŸ…", "ğŸ", "ğŸ””", "âœ¨", "â›„", "ğŸ¦Œ", "â˜•", "â„ï¸", "ğŸ§¤", "ğŸ„", "ğŸŒŸ", "ğŸ¬"];
Â  Â  Â  Â  Â  Â  const grid = document.querySelector('.product-grid');

            // 1. INICIALIZAR NIEVE INMEDIATAMENTE
            initSnowfall();

            activateChristmasDayMode();
            
            // 2. AÃ‘ADIR LISTENER DE REDIMENSIONAMIENTO (resize)
            // Esto es crucial para reajustar la altura si el usuario cambia el tamaÃ±o de la ventana (o gira el mÃ³vil)
            window.addEventListener('resize', () => {
                // Usamos setTimeout para dar tiempo a que el navegador termine el cÃ¡lculo de layout
                setTimeout(adjustSnowflakeHeight, 50);
            });

Â  Â  Â  Â  Â  Â  // 3. CARGAR DATOS (fetch)
Â  Â  Â  Â  Â  Â  fetch('datos.json')
Â  Â  Â  Â  Â  Â  Â  Â  .then(response => response.json())
Â  Â  Â  Â  Â  Â  Â  Â  .then(data => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  data.forEach(amigo => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const card = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  card.className = 'product-card';
                        // ... (resto de la lÃ³gica de la tarjeta) ...
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const randomIcon = iconList[Math.floor(Math.random() * iconList.length)];
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  card.onclick = () => openModal(
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  amigo.Nombre_ApellidoPaterno,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  'amigo.jpg',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  `Edad: ${amigo.edad}, Hobbies: ${amigo.hobbies}, Ãrea: ${amigo.Area}`,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  amigo.detalleSecreto
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  );
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  card.innerHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="card-icon-emoji">${randomIcon}</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-content">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <img src="amigo.jpg" alt="Foto de ${amigo.Nombre_ApellidoPaterno}">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h3>${amigo.Nombre_ApellidoPaterno}</h3>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p>${amigo.Area.split('.')[0]}</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  grid.appendChild(card);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
                    // âœ… AJUSTE FINAL: Se llama despuÃ©s de que las tarjetas estÃ¡n en el DOM.
Â  Â  Â  Â  Â  Â  Â  Â  })
Â  Â  Â  Â  Â  Â  Â  Â  .catch(error => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.error('Error al cargar datos.json:', error);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  grid.innerHTML = '<p>No se pudieron cargar los datos del intercambio.</p>';
Â  Â  Â  Â  Â  Â  Â  Â  });
            setTimeout(adjustSnowflakeHeight, 50);
Â  Â  Â  Â  Â  Â  // 4. LOADER
Â  Â  Â  Â  Â  Â  const loader = document.getElementById('christmas-loader');
Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  loader.style.opacity = '0';
Â  Â  Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  loader.style.display = 'none';
Â  Â  Â  Â  Â  Â  Â  Â  }, 500);
Â  Â  Â  Â  Â  Â  }, 1500);

            // 5. LISTENERS DEL MODAL (AÃ±adimos los listeners al DOMContentLoaded para que funcionen)
            closeBtn.onclick = function () {
Â  Â  Â  Â  Â  Â      modal.style.display = 'none';
                document.body.classList.remove('modal-open');
Â  Â  Â  Â      }

Â  Â  Â  Â      window.onclick = function (event) {
Â  Â  Â  Â  Â  Â      if (event.target === modal) {
Â  Â  Â  Â  Â  Â  Â  Â      modal.style.display = 'none';
                    document.body.classList.remove('modal-open');
Â  Â  Â  Â  Â  Â      }
Â  Â  Â  Â      }

Â  Â  Â  Â  });
Â  Â  </script>
</body>
</html>